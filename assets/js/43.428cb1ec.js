(window.webpackJsonp=window.webpackJsonp||[]).push([[43],{468:function(e,t,a){"use strict";a.r(t);var s=a(65),r=Object(s.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"quarantine-pattern"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#quarantine-pattern"}},[e._v("#")]),e._v(" Quarantine Pattern")]),e._v(" "),a("p",[e._v("To assure a registry only contains images that have been vulnerability scanned, ACR introduces the Quarantine pattern.\nWhen a registries policy is set to Quarantine Enabled, all images pushed to that registry are put in quarantine by default. Only after the image has been verifed, and the quarantine flag removed may a subsequent pull be completed.")]),e._v(" "),a("blockquote",[a("p",[e._v("Note: This is an early preview of this workflow. Additional capabilities will be added, including CLI and Portal support.")])]),e._v(" "),a("h1",{attrs:{id:"current-workflow"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#current-workflow"}},[e._v("#")]),e._v(" Current Workflow")]),e._v(" "),a("h2",{attrs:{id:"quarantined-webhook-notification"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#quarantined-webhook-notification"}},[e._v("#")]),e._v(" Quarantined Webhook Notification")]),e._v(" "),a("p",[e._v('No matter if you have quarantine flow enabled or not, scanner can always subscribe to the "quarantine" webhook. when an image is pushed, we will try to notify the matching "quarantine" webhook, with payload as below:')]),e._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"id"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"0d799b14-404b-4859-b2f6-50c5ee2a2c3a"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"timestamp"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"2018-02-28T00:42:54.4509516Z"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"action"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"quarantine"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"target"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"size"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("1791")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"digest"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"sha256:91ef6"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"length"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("1791")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"repository"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"helloworld"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"tag"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"request"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"id"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"978fc988-zzz-yyyy-xxxx-4f6e331d1591"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"host"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"[registry].azurecr.io"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"method"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"PUT"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br"),a("span",{staticClass:"line-number"},[e._v("8")]),a("br"),a("span",{staticClass:"line-number"},[e._v("9")]),a("br"),a("span",{staticClass:"line-number"},[e._v("10")]),a("br"),a("span",{staticClass:"line-number"},[e._v("11")]),a("br"),a("span",{staticClass:"line-number"},[e._v("12")]),a("br"),a("span",{staticClass:"line-number"},[e._v("13")]),a("br"),a("span",{staticClass:"line-number"},[e._v("14")]),a("br"),a("span",{staticClass:"line-number"},[e._v("15")]),a("br")])]),a("p",[e._v("You can use our "),a("a",{attrs:{href:"https://docs.microsoft.com/en-us/rest/api/containerregistry/webhooks/create",target:"_blank",rel:"noopener noreferrer"}},[e._v("management Webhook API"),a("OutboundLink")],1),e._v(' to create and subscribe for the "quarantine" webhook (the actions field need to use the "quarantine" action).')]),e._v(" "),a("blockquote",[a("blockquote",[a("p",[e._v("In order to call the above management API, you need to get an access token which is be used as the Authorization header . Here is an "),a("a",{attrs:{href:"https://blogs.technet.microsoft.com/stefan_stranger/2016/10/21/using-the-azure-arm-rest-apin-get-access-token/",target:"_blank",rel:"noopener noreferrer"}},[e._v("example"),a("OutboundLink")],1),e._v(" on how to get access token for a Service Principal:")])])]),e._v(" "),a("blockquote",[a("blockquote")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('curl --request POST "https://login.windows.net/{TenantId}/oauth2/token" --data-urlencode "resource=https://management.core.windows.net" --data-urlencode "client_id={appId}" --data-urlencode "grant_type=client_credentials" --data-urlencode "client_secret={app secret}"\n')])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("p",[e._v('Before Quarantine is configured on the registry, both "quarantine" and "push" webhook will be raised for each image push. The scanner can subscribe to "quarantine" webhook and conduct security scan for the newly pushed image; while normal user can subscribe to the normal "push" webhook and pull the image successfully.')]),e._v(" "),a("h2",{attrs:{id:"configure-quarantine-on-a-registry"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#configure-quarantine-on-a-registry"}},[e._v("#")]),e._v(" Configure Quarantine on a registry")]),e._v(" "),a("p",[e._v("Once a user decides to enable Quarantine on a registry, he can use our "),a("a",{attrs:{href:"https://docs.microsoft.com/en-us/rest/api/containerregistry/registries/update#policies",target:"_blank",rel:"noopener noreferrer"}},[e._v("management Policy API"),a("OutboundLink")],1),e._v(".")]),e._v(" "),a("p",[e._v('Once Quarantine is enabled on a registry, for newly pushed image, it will enter quarantine state automatically and only a user with quarantine reader permissions can see the image. Meanwhile, the same "quarantine" webhook will be raised, but no "push" notification anymore. This gives the scanner a chance to scan the image first before making it available to other users.')]),e._v(" "),a("p",[e._v('Once scanner finishes scanning the image, it can mark the image as good, which will make this image available to all other users. Meanwhile a "push" notification is generated so that other users are notified.')]),e._v(" "),a("blockquote",[a("p",[e._v("Please note, once the Quarantine is enabled, any images without being marked as good will be blocked for pull. This may impact user's ongoing workflow. We would recommend that before enable Qurantine mode on the registry, the scanner should finish scanning all the existing images (this can be done by using catalog API and manifest list API). User can then look at the failed images and decide if he should enable the Quarantine mode.")])]),e._v(" "),a("p",[e._v("The detailed flow is described below.")]),e._v(" "),a("h2",{attrs:{id:"name-your-registry"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#name-your-registry"}},[e._v("#")]),e._v(" name your registry")]),e._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("export")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("ACR_NAME")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("quarantine\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("export")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("REGISTRY_NAME")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$ACR_NAME")]),e._v(".azurecr.io\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br")])]),a("h2",{attrs:{id:"login-to-the-dogfood-registry"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#login-to-the-dogfood-registry"}},[e._v("#")]),e._v(" Login to the dogfood registry")]),e._v(" "),a("p",[a("code",[e._v("docker login $REGISTRY_NAME")])]),e._v(" "),a("h2",{attrs:{id:"push-an-image"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#push-an-image"}},[e._v("#")]),e._v(" Push an image")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("docker push  ${REGISTRY_NAME}helloworld:1\n 96c922e98de8: Pushed\n digest: sha256:80f0d5cxxxxXxxXxxxxece0db56d11cdc624ad20da9fe62d7d size: 524\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br")])]),a("p",[e._v("The image is now quarantined")]),e._v(" "),a("h2",{attrs:{id:"attempt-to-pull-the-quarantined-image"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#attempt-to-pull-the-quarantined-image"}},[e._v("#")]),e._v(" Attempt to pull the quarantined image")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("docker pull  ${REGISTRY_NAME}helloworld:1\nError response from daemon: manifest for quarantinetest1.azurecr.io/helloworld:1 not found\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br")])]),a("h2",{attrs:{id:"attempt-to-pull-the-image-by-its-digest"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#attempt-to-pull-the-image-by-its-digest"}},[e._v("#")]),e._v(" Attempt to pull the image by its digest")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("docker pull ${REGISTRY_NAME}helloworld@sha256:80f0d5cxxxxXxxXxxxxece0db56d11cdc624ad20da9fe62d7d\n\t\tError response from daemon: unknown: The operation is disallowed.\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br")])]),a("h2",{attrs:{id:"quarantined-webhook-notification-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#quarantined-webhook-notification-2"}},[e._v("#")]),e._v(" Quarantined Webhook Notification")]),e._v(" "),a("p",[e._v("Once the image is pushed, you will receive a notification through webhooks.")]),e._v(" "),a("h2",{attrs:{id:"pull-the-quarantined-image"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pull-the-quarantined-image"}},[e._v("#")]),e._v(" Pull the quarantined image")]),e._v(" "),a("p",[e._v("Once the image is quarantined, you will need user with the "),a("strong",[e._v("AcrQuarantineReader")]),e._v(" role. The presumption here is the Vulnerability Scanning solution is configured to use this account.")]),e._v(" "),a("p",[a("code",[e._v("docker login ${REGISTRY_NAME} -u")]),e._v(" "),a("strong",[e._v("[quarantinedServicePrincpalUsr]")]),a("code",[e._v("-p")]),a("strong",[e._v("[quarantinedServicePrincpalPwd]")])]),e._v(" "),a("p",[e._v("Now the user can pull the quarantined image by digest")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("docker pull [registry].azurecr.io/helloworld@sha256:sha256:80f0d5cxxxxXxxXxxxxece0db56d11cdc624ad20da9fe62d7d\n  Pulling from helloworld\n\tDigest: sha256:80f0d5cxxxxXxxXxxxxece0db56d11cdc624ad20da9fe62d7d\n\tStatus: Image is up to date for [registry].azurecr.io/helloworld@sha256:80f0d5cxxxxXxxXxxxxece0db56d11cdc624ad20da9fe62d7d\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br")])]),a("h2",{attrs:{id:"query-attributes-of-an-image-manifest"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#query-attributes-of-an-image-manifest"}},[e._v("#")]),e._v(" Query Attributes of an Image (manifest)")]),e._v(" "),a("p",[e._v("Querying ACR metadata via the REST API requires an OAuth Token.")]),e._v(" "),a("p",[e._v("To query attributes via REST, use the following workflow:")]),e._v(" "),a("ol",[a("li",[e._v("encode the username/password with the required permissions")]),e._v(" "),a("li",[e._v("get an access token")]),e._v(" "),a("li",[e._v("query acr metadata for the attributes of a given digest")])]),e._v(" "),a("h3",{attrs:{id:"get-an-acr-access-token-for-the-user"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#get-an-acr-access-token-for-the-user"}},[e._v("#")]),e._v(" Get an ACR access token for the user")]),e._v(" "),a("p",[e._v("Please refer to "),a("a",{attrs:{href:"https://github.com/Azure/acr/tree/master/docs/Token-BasicAuth.md",target:"_blank",rel:"noopener noreferrer"}},[e._v("this document"),a("OutboundLink")],1),e._v(" on how to get an access token.")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("example: \n```\nGET https://quarantinetest1.azurecr.io/oauth2/token?service=quarantinetest1.azurecr.io&scope=repository:helloworld:pull\n```\n")])])]),a("h3",{attrs:{id:"query-the-metadata-api"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#query-the-metadata-api"}},[e._v("#")]),e._v(" Query the metadata API")]),e._v(" "),a("ul",[a("li",[a("p",[e._v("With an OAuth token, we can now query ACR metadata:")]),e._v(" "),a("p",[e._v("REST format: "),a("code",[e._v("https://")]),a("strong",[e._v("[login-url]")]),a("code",[e._v("/acr/v1/")]),a("strong",[e._v("[image]")]),a("code",[e._v("/_manifests/")]),a("strong",[e._v("[digest]")])])]),e._v(" "),a("li",[a("p",[e._v("Set the header for Authorization, setting the OAuth token")]),e._v(" "),a("table",[a("thead",[a("tr",[a("th",[e._v("Header")]),e._v(" "),a("th",[e._v("Value")])])]),e._v(" "),a("tbody",[a("tr",[a("td",[e._v("Authorization")]),e._v(" "),a("td",[e._v("Bearer [token]")])]),e._v(" "),a("tr",[a("td",[e._v("Host")]),e._v(" "),a("td",[e._v("[login-url]")])])])]),e._v(" "),a("p",[e._v("example:")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("GET https://quarantinetest1.azurecr.io/acr/v1/mytest/_manifests/sha256:80f0d5cxxxxXxxXxxxxece0db56d11cdc624ad20da9fe62d7d\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])])])]),e._v(" "),a("h2",{attrs:{id:"remove-the-quarantine-flag"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#remove-the-quarantine-flag"}},[e._v("#")]),e._v(" Remove the Quarantine Flag")]),e._v(" "),a("p",[e._v("Once a scan completes, a user with the "),a("strong",[e._v("AcrQuarantineWriter")]),e._v(" role can update the manifest attribute to removed the quarantined flag.")]),e._v(" "),a("h3",{attrs:{id:"get-an-acr-push-access-token-for-the-user"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#get-an-acr-push-access-token-for-the-user"}},[e._v("#")]),e._v(" Get an ACR Push access token for the user")]),e._v(" "),a("p",[e._v("Please refer to "),a("a",{attrs:{href:"https://github.com/Azure/acr/tree/master/docs/Token-BasicAuth.md",target:"_blank",rel:"noopener noreferrer"}},[e._v("this document"),a("OutboundLink")],1),e._v(" on how to get an access token.")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("example: \n```\nGET https://quarantinetest1.azurecr.io/oauth2/token?service=quarantinetest1.azurecr-test.io&scope=repository:helloworld:pull,push\n```\n")])])]),a("h3",{attrs:{id:"remove-the-quarantine-flag-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#remove-the-quarantine-flag-2"}},[e._v("#")]),e._v(" Remove the Quarantine Flag")]),e._v(" "),a("ul",[a("li",[a("p",[e._v("Update manifest attributes using the access token."),a("br"),e._v("\nREST format: "),a("code",[e._v("PATCH https://")]),a("strong",[e._v("[login-url]")]),e._v("/"),a("code",[e._v("acr/v1/")]),a("strong",[e._v("[image]")]),a("code",[e._v("/_manifests/")]),a("strong",[e._v("[digest]")])]),e._v(" "),a("p",[e._v("Payload:")]),e._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[e._v("    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"quarantineState"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"[Passed|Failed]"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"quarantineDetails"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"[json string of detailed results]"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br")])]),a("blockquote",[a("p",[e._v("Note: the quarantineDetails schema is defined at "),a("a",{attrs:{href:"https://github.com/Azure/acr/tree/master/docs/preview/quarantine/quarantine-details/schema.json",target:"_blank",rel:"noopener noreferrer"}},[e._v("here"),a("OutboundLink")],1)])]),e._v(" "),a("table",[a("thead",[a("tr",[a("th",[e._v("Header")]),e._v(" "),a("th",[e._v("Value")])])]),e._v(" "),a("tbody",[a("tr",[a("td",[e._v("Authorization")]),e._v(" "),a("td",[e._v("Bearer [token]")])]),e._v(" "),a("tr",[a("td",[e._v("Host")]),e._v(" "),a("td",[e._v("[login-url]")])])])]),e._v(" "),a("p",[e._v("example:")]),e._v(" "),a("p",[e._v("PATCH https://quarantinetest1.azurecr.io/acr/v1/mytest/_manifests/sha256:80f0d5c8786bb9e621a45ece0db56d11cdc624ad20da9fe62e9d25490f331d7d HTTP/1.1")]),e._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[e._v("    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"quarantineState"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Passed"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" \n        "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"quarantineDetails"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"{\\"state\\":\\"scan passed\\",\\"link\\":\\"http://test.io/test\\"}"')]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br")])])])]),e._v(" "),a("h2",{attrs:{id:"image-pushed-webhook-notification"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#image-pushed-webhook-notification"}},[e._v("#")]),e._v(" Image Pushed Webhook Notification")]),e._v(" "),a("p",[e._v("Based on the registry policy, once the image has been set to "),a("strong",[e._v("Passed")]),e._v(", a Image Pushed webhook will triggered")]),e._v(" "),a("h2",{attrs:{id:"image-pull"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#image-pull"}},[e._v("#")]),e._v(" Image Pull")]),e._v(" "),a("p",[e._v("With the quarantine removed, a user with standard "),a("strong",[e._v("reader")]),e._v(" role can pull the image, using the tag")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("docker login ${REGISTRY_NAME}\ndocker pull ${REGISTRY_NAME}helloworld:1\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br")])])])}),[],!1,null,null,null);t.default=r.exports}}]);